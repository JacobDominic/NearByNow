<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Crafts</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://me.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=CxN3mnRfzZT_Ws4Cd6eYwoRDpYikOyevCMoolbe_euj46GRRkzKbPF8ldwc9aAOs7vP4Ah5blwb7flU--YvHUaAjxL2l6M8D7XBbVZtwWfLCTPhzgll33IiOZ0_xiQ5eSx0ntloibjwskDkUhfk2GEecX86wBdAa3qMXbn7mse4mKglkKm8YGUGk4TyBVTqt7ZHTTN6EMmkAkCctCB7qPx0OeHK7Wiur17AnVGyP_d3ag9NFYbIJryaNNlwgeq-gv54PFIiiHUCUn3XbHmZTPgC7Fj-fGeevwPqmNIpba71_0xuKHmDQ4UYOpRcehWUC2W3_dn0NUfC-UlAYahZZr5MSYLBm28wA4l7GYcKHXZPu_BMElaEpd-XgCWd1aBrmjwcjU9GqkF22NwlBaobl92pGwKKYT3UgTPGHg73o_xXKQPsRsG0wXIVlEeIZJCfme9dpr1Ia4OIKX19uEdSill5JzAvNEYPIg0xLfNSSRWb7zvIm-oR0QQF9efM9p_yq3ElF2rGR0H8wRIHa1WpAk9K-yWDFx6LB-s1tWIe-frcaOxUWkzfyHzzGMUkcGz1QLbVLddRk8RdjtBPxMKKi4gbOGm3Z3JOfGT8xsh2Ngb0lg36li0W1zxW4lhr486PjmvGYqyMLeKrm-emeCxv2lSj_SsEsjTopDencT4c9MeT1O1KwVkczlbkjtgeBNsS7Pi56Wqq2uwBwHqWMZmRrQnToilYpXlh7G6Cs7vBsoECIPeRj9Eu_Pini0ZVVu9vHASBWirxVYOG9bKp6qkywum7teY1g1LQTCGWcTsO85OfO4G7AbT6V765TEdklZdeSCO6tETOyQbMwk2fUXeDoGQ9EUWcnx8bRYewA-g8UTSz77Rjl7rx9vmgjQ7BAlSq-gwrePdTGZE74BjyKtkhtUfQ9UlKlU1NS0T7dBzIvETCXKboqEKovz_eMKhFz9mxN_0eps1YJAkOocEOLuhAHkY5paw2bfye75JsJ38b4ZyOUHrbxJ4l-Od42_ZfXXLod08GKBGvR3YViHJNvQ4eueWF6Lam0KgaJ230jl2dO786MDbSl28o0xV_AOPXPBaiHnZR2uLRxV6hK8QMp71Vs6rHL6dIbyY4qOKpcwB31SXsIR-WAiwnb_YmBcxZNhNZpEhrDeBFEGxHhYVsEAJQvTt_Y5rW1S72iE5XzfEKdj2oi-ssHZHWdRORQpyxpkT9T9Qq7N92TqqK3qVgIWS3eTaq3RM9loM0NvGMsfQh_DKWl39YD57JpY61D1OTo1yonTH_rTKnl2LDas6ngdvSXVx8RiwxzadX3GN2Ty1Z4G_ABuAylrB6Af7kaWOy2u75shOKyX_6w_UYeuZQduMNtkZOJ4-PrV1Rf1mnx1ulYFeNk1eHHpTW4l0r1VCjlcsidSR-Zzwf3-WwAHSxcQcs6fV4uTeE7IxnUJp-dQxyiTHDY-DOMm_wtutqp_tR8qNnit8rtonIXehbL63l8jQGqb-0pTUKu75Zh3N5ecKJOsilnv01hU5brXuUw5ks-Xmv0Rxx4D6z3ztpVxqYsMWzRQFF3xpNsbLJ_rPsLWygw_RtVTMuJNt1g5k8TpfQcKAK3O_d6asBOyiOznCsi3sZv03M7mL3hTosqPMUrIuVZV-uvaWBd4dVmLXHfcMcgWu78ErH0dP9di9s1xiPU07jH40H1sNeOWua9-evFKfgFBlQQn1agrQJSdCNrAUsG6zUIjpyct3FDzlqmq3vtu4grYzzKEOnwUZ0npoG5h2nxe4Y" nonce="8b8a11c40dca7e405b2408b6efdd5384" charset="UTF-8"></script><style>
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background-color: #f0f7f4;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: white;
            color: black;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .logo img {
            width: 120px;
            height: auto;
        }

        .home-btn {
            font-size: 1.5rem;
            color: #000000;
            background: none;
            border: none;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .home-btn:hover {
            color: #e07415;
        }

        .content {
            padding: 2rem;
            text-align: center;
        }

        .content h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        /* Filtering Section */
        .filter {
            padding: 1rem 2rem;
            text-align: center;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .filter select {
            padding: 0.5rem;
            font-size: 1rem;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            padding: 0 2rem;
        }

        .gallery-item {
            width: 300px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            text-align: center;
            padding: 1rem;
        }

        .gallery img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
        }

        .item-details {
            margin-top: 0.5rem;
            font-size: 1rem;
            color: #555;
        }

        .item-details p {
            margin: 0.5rem 0;
        }

        .actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        .add-to-cart {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            background-color: #e07415;
            color: white;
            transition: background-color 0.3s ease;
        }

        .add-to-cart:hover {
            background-color: #c96110;
        }

        .heart-icon {
            font-size: 1.5rem;
            color: white;
            border: 2px solid black;
            border-radius: 50%;
            padding: 0.2rem;
            cursor: pointer;
            transition: color 0.3s, background-color 0.3s, border-color 0.3s;
        }

        .heart-icon.clicked {
            color: red;
            border-color: red;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="logo">
            <img src="../static/image/minilogo.png" alt="NearbyNow Logo"> <!-- Image logo instead of text -->
        </div>
        <div style="margin-left: auto; display: flex; align-items: center; gap: 1.5rem;">
            <span class="icon" style="font-size: 1.8rem; cursor: pointer;" onclick="window.location.href='/cart'">üõí</span> <!-- Cart Icon -->
            <span class="icon" style="font-size: 1.8rem; cursor: pointer;" onclick="window.location.href='/wishlist'">‚ù§</span> <!-- Wishlist Icon -->
            <button class="home-btn" onclick="window.location.href='/mininew'">
            <i class="fas fa-home"></i>
            </button>
        </div>
    </header>

    

    <!-- Filter Section just above the gallery -->
    <div class="filter">
        <label for="priceFilter">Filter by Price: </label>
        <!-- <select id="priceFilter" onchange="filterItems()">
            <option value="all">All</option>
            <option value="200">Rs. 200</option>
            <option value="250">Rs. 250</option>
            <option value="150">Rs. 150</option>
            <option value="180">Rs. 180</option>
        </select> -->
        <input type="number" id="priceFilter" onchange="filterItems()">
    </div>

    <div class="gallery" id="craftGallery">
       <!-- Placeholder for when no items match filter -->
       <div class="no-items" style="display: none;">Oops! Nothing to see here</div>
    </div>
       <script>
        document.addEventListener('DOMContentLoaded', loadCrafts);

async function loadCrafts() {
    try {
        const response = await fetch('/getcraftitems'); // Call backend API
        const crafts = await response.json(); // Parse response
        const gallery = document.getElementById('craftGallery');
        gallery.innerHTML = ''; // Clear previous items

        crafts.forEach(craft => {
            const item = document.createElement('div');
            item.className = 'gallery-item';
            item.setAttribute('data-price', craft.price);

            item.innerHTML = `
                <img src="${craft.image}" alt="${craft.title}">
                <div class="item-details">
                    <p><strong>${craft.title}</strong></p>
                    <p>Rs. ${craft.price}</p>
                    <p>${craft.description}</p>
                    <div class="actions">
                        <button class="add-to-cart" onclick="addToCart('${craft.id}', '${craft.title}', '${craft.price}', '${craft.image}')">Add to Cart</button>
                        <i class="far fa-heart heart-icon" onclick="toggleHeart(this, '${craft.id}', '${craft.title}', '${craft.price}', '${craft.image}')"></i>
                    </div>
                </div>
            `;
            gallery.appendChild(item);
        });
    } catch (error) {
        console.error('Error fetching craft items:', error);
    }
}

async function addToCart(itemId, title, price, image) {
    try {
        const response = await fetch('/addtocart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams({
                item_id: itemId,
                title: title,
                price: price,
                image: image,
            }),
        });

        const result = await response.json();
        if (result.success) {
            alert(result.message);
        } else {
            alert(result.error || 'Failed to add item to cart.');
        }
    } catch (error) {
        console.error('Error adding item to cart:', error);
    }
}

async function addToWishlist(itemId, title, price, image) {
    try {
        const response = await fetch('/addtowishlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams({
                item_id: itemId,
                title: title,
                price: price,
                image: image,
            }),
        });

        const result = await response.json();
        if (result.success) {
            alert(result.message);
        } else {
            alert(result.error || 'Failed to add item to wishlist.');
        }
    } catch (error) {
        console.error('Error adding item to wishlist:', error);
    }
}

function toggleHeart(icon, itemId, title, price, image) {
    icon.classList.toggle('clicked');

    if (icon.classList.contains('clicked')) {
        addToWishlist(itemId, title, price, image);
    }
}
function filterItems() {
            console.log("hello")
            const priceFilter = document.getElementById('priceFilter').value;
            const items = document.querySelectorAll('.gallery-item');
            let visibleItems = 0;
            console.log(items)
            items.forEach(item => {
                const price = parseInt(item.getAttribute('data-price'));
                console.log(price);
                if (priceFilter === 'all' || price <= priceFilter) {
                    item.style.display = 'block';
                    visibleItems++;
                } else {
                    item.style.display = 'none';
                }
            });

            // Display 'Oops! Nothing to see here' if no items match the filter
            const noItemsMessage = document.querySelector('.no-items');
            if (visibleItems === 0) {
                noItemsMessage.style.display = 'block';
            } else {
                noItemsMessage.style.display = 'none';
            }
        }

async function loadItems(category) {
    try {
        const response = await fetch(`/getitems/${category}`);
        const items = await response.json();

        const gallery = document.getElementById('gallery');
        gallery.innerHTML = ''; // Clear previous items

        items.forEach(item => {
            const itemElement = document.createElement('div');
            itemElement.className = 'gallery-item';

            itemElement.innerHTML = `
                <img src="${item.image}" alt="${item.title}">
                <div class="item-details">
                    <p><strong>${item.title}</strong></p>
                    <p>Rs. ${item.price}</p>
                    <p>${item.description}</p>
                </div>
            `;
            gallery.appendChild(itemElement);
        });
    } catch (error) {
        console.error('Error loading items:', error);
    }
}
    </script>
</body>

</html>
